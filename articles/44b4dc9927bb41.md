---
title: "Flutterã§è¤‡æ•°è§£åƒåº¦ã®GoldenTestã‚’åŒæ™‚å®Ÿè¡Œã—ã¦ã¿ãŸ"
emoji: "ğŸ“"
type: "tech"
topics:
  - "flutter"
  - "test"
  - "golden"
published: true
published_at: "2021-10-20 21:47"
---

ä»Šå›ã¯è¤‡æ•°è§£åƒåº¦ï¼ˆè¤‡æ•°ç«¯æœ«ï¼‰ã‚’åŒæ™‚ã«ãƒ†ã‚¹ãƒˆã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

GoldenTestãªã«ãã‚Œã£ã¦æ–¹ã¯å‰å›ã®è¨˜äº‹ã‚’å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚
https://zenn.dev/matsumaru/articles/c2bf8ec468cff8

# ã‚„ã‚ŠãŸã„ã“ã¨
![firstPage_masterImage](https://user-images.githubusercontent.com/73928886/137845851-fe8d2149-e161-4a09-b766-3fabda7ca6b6.png)

ç”»åƒã®ã‚ˆã†ã«ã€**è‰²ã‚“ãªã‚µã‚¤ã‚ºã®ãƒ‡ãƒã‚¤ã‚¹ã‚’ã¾ã¨ã‚ã¦ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆåŒ–**ã—ã¦ãã‚Œã‚‹ã®ã§è¦‹ãŸç›®ã®éƒ¨åˆ†ã®ç¢ºèªã‚‚ã§ãã‚‹ã—ã€ã‚‚ã¡ã‚ã‚“ã‚³ãƒ¼ãƒ‰ã®ä¸­èº«ã‚’å¤‰æ›´ã—ãŸæ™‚ã«UIãŒå¤‰ã‚ã£ã¦ã„ãªã„ã‹ãƒ†ã‚¹ãƒˆã‚‚ã§ãã¾ã™ã€‚

ã‘ã£ã“ã†ç°¡å˜ãªã®ã§ä½¿ã£ã¦ã¿ã‚‹ã®ã‚ªã‚¹ã‚¹ãƒ¡ã§ã™ã€‚

# å‰ææ¡ä»¶
ä»Šå›ã‚‚[golden_toolkit](https://pub.dev/packages/golden_toolkit)ã‚’ä½¿ã„ã¾ã™ã€‚ã“ã‚Œã‹ã‚‰ã‚„ã‚‹ã“ã¨ã‚‚å…¬å¼ã‚µã‚¤ãƒˆã«æ›¸ã„ã¦ã‚ã‚Šã¾ã™ã€‚

ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å°å…¥ã¯å‰å›ã®è¨˜äº‹ã«æ›¸ã„ãŸã®ã§çœãã¾ã™ã€‚

# ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰
ä¸€å¿œGithubã¯ã‚ã’ã¦ãŠãã¾ã—ãŸã®ã§ã€è©³ç´°æ°—ã«ãªã‚‹æ–¹ã¯å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚
https://github.com/MatsumaruTsuyoshi/golden_test_string_over_demo

# ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
ä»¥ä¸‹ã‚³ãƒ¼ãƒ‰ã§ã€FirstPageã¨ã„ã†Widgetã‚’è¤‡æ•°è§£åƒåº¦ã§GoldenTestã§ãã¾ã™ã€‚
FirstPageã¯Textã¨ButtonãŒã‚ã‚‹ã ã‘ã®ã‚·ãƒ³ãƒ—ãƒ«ãªç”»é¢ã§ã™ã€‚ä»»æ„ã«ç½®ãæ›ãˆã¦å¤§ä¸ˆå¤«ã§ã™ã€‚
```dart:first_page_golden_test.dart
void main() {
  testGoldens('firstPage', (WidgetTester tester) async {
    //é…åˆ—ã§è¤‡æ•°è§£åƒåº¦ã‚’è¿½åŠ ã—ã¦ã„ã
    final builder = DeviceBuilder()
      ..overrideDevicesForAllScenarios(devices: [
        Device.phone,
        Device.iphone11,
        Device.tabletPortrait,
        Device.tabletLandscape,
      ])
      
      //ã©ã®Widgetã§ãƒ†ã‚¹ãƒˆã™ã‚‹ã‹æŒ‡å®šã™ã‚‹
      ..addScenario(
        widget: FirstPage(),
        name: 'default page',
      );
      
    //è¤‡æ•°è§£åƒåº¦ã§ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹
    await tester.pumpDeviceBuilder(builder);
    //ãƒã‚¹ã‚¿ãƒ¼ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã¨ç¾åœ¨ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’æ¯”è¼ƒãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹
    await screenMatchesGolden(tester, 'firstPage');
  });
}
```
ã“ã“ã¾ã§æ›¸ã‘ãŸã‚‰ä»¥ä¸‹ã‚³ãƒãƒ³ãƒ‰ã‚’å©ã„ã¦Goldenï¼ˆãƒã‚¹ã‚¿ãƒ¼ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆï¼‰ã‚’ä½œæˆã—ã¾ã™ã€‚
```
flutter test --update-goldens
```
ç„¡äº‹ã«æˆåŠŸã™ã‚Œã°goldenãƒ•ã‚©ãƒ«ãƒ€ãŒç”Ÿæˆã•ã‚Œã¦ã€ãã®é…ä¸‹ã«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆãŒå‡ºæ¥ä¸ŠãŒã‚Šã¾ã™ã€‚
![firstPage_masterImage](https://user-images.githubusercontent.com/73928886/137845851-fe8d2149-e161-4a09-b766-3fabda7ca6b6.png)

ã‚ã¨ã¯ã€ä»¥ä¸‹ã‚³ãƒãƒ³ãƒ‰ã‚’å©ã‘ã°goldenãƒ•ã‚©ãƒ«ãƒ€ã®ãƒã‚¹ã‚¿ãƒ¼ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã¨ç¾åœ¨ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’æ¯”è¼ƒã—ã¦ã°ã¡ã‚ƒã‚“ã¨WidgetTestã—ã¦ãã‚Œã¾ã™ã€‚
```
flutter test
```

# çµ‚ã‚ã‚Šã«
ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãŒã¡ã‚ƒã‚“ã¨å‡ºæ¥ã¦ã„ã‚‹ã‹å®Ÿæ©Ÿã‚„ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦ç¢ºèªã™ã‚‹ã®ã£ã¦åœ°å‘³ã«ã ã‚‹ã„ã®ã§ã€ãƒ†ã‚¹ãƒˆã«ä½¿ã‚ãªã„ã¨ã—ã¦ã‚‚ã‘ã£ã“ã†ä¾¿åˆ©ã ãªã¨æ€ã„ã¾ã—ãŸã€‚