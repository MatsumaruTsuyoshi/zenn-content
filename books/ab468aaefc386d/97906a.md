---
title: "レイヤードアーキテクチャとは"
free: false
---

# レイヤードアーキテクチャの概要

レイヤードアーキテクチャの抑えておくべきポイントは２つです。

１つめ、**依存性は、より上位レベルの方針にのみ向ける**
２つめ、**制御の流れと依存方向を分離し制御せよ**

難しい言葉が並んでいますが、**依存性の方向を意識して分離する**ということです。

細かい話をすると、レイヤードアーキテクチャは以下表のように４層に分かれていますがこれにガチガチに当てはめようとすると混乱してくるのでなんとなーく理解する程度がちょうどいいかなと考えています。
| 層 | 意味合い |
| ---- | ---- |
| プレゼンテーション | UIの部分 |
| アプリケーション | 声出すだけのやつでなんもしない |
| ドメイン | ルールを持っている |
| インフラストラクチャ | 実際の現場で働いている人 |

こうやってみると会社の組織割のような感じにも見えます。

ここで大事なのが、**依存関係は上の層から下の層のみに依存する**ことです。つまり、インフラストラクチャはドメインやアプリケーション、プレゼンテーションが変更されても何も影響を受けない状態のことを示します。

依存関係を正しくしていると、責任の所在がはっきりするし、テストするのにも便利だよねっていうのがレイヤードアーキテクチャの考え方です。

考えてみると現実世界にもレイヤードアーキテクチャ的なものってたくさんあります。例えばフルーツジュース屋さんです。

上の表でいうプレゼンテーション層はフルーツジュースそのもので、インフラストラクチャ層はミキサーでフルーツをジュースにする作業とします。フルーツジュースを作るのにミキサーは必要なのでフルーツジュースはミキサーに依存しています。しかし、ミキサーはどんなフルーツが来てもかき混ぜるだけなのでどんな組み合わせのフルーツジュースを作るとしてもやることは変わりません。つまり、上の層には依存していません。

さらに、新しいフルーツジュースを販売となれば、販売前にお客さんから注文されたと仮定して実際に作ってみたりしますよね。それってテストと同じ構図です。

つまり現実世界での便利な仕組みを体系化してレイヤードアーキテクチャというかっこいい名前をつけているに過ぎないので、難しく考えすぎる必要はないかなと個人的に思っています。

# レイヤードアーキテクチャのメリット


ソフトウェアの世界で考えてみると、依存関係が正しい関係にあればアプリの変更に対して柔軟な対応が取れます。

例えば、インフラストラクチャの層の仕事として、データベースからデータを取得することがあります。このデータベースがクラウドからローカルに変更したときにプレゼンテーション層であるUIは影響を受けません。責任の分離をしておくと変更した時の影響を最小限にできます。


# レイヤードアーキテクチャのデメリット

簡単なアプリでは単純にコード量が増えるので、ただ単にレイヤードアーキテクチャを採用すればいいわけでもありません。



# 参考にした記事
もっと詳しく知りたい方は以下記事を参考にしてください。
https://www.slideshare.net/AtsushiNakamura4/clean-architecture-release
https://note.com/erukiti/n/n913e571e8207#LDdhv
https://gist.github.com/mpppk/609d592f25cab9312654b39f1b357c60
https://qiita.com/kichion/items/aca19765cb16e7e65946
https://github.com/Atsumi3/FlutterPracticeGraphQL-DDD